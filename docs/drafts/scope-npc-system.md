# åŠŸèƒ½æ¢è®¨: NPC ç³»ç»Ÿç»†åŒ–è®¾è®¡

## åŸºæœ¬ä¿¡æ¯

- **åˆ›å»ºæ—¶é—´**: 2026-02-04
- **å…³è”é¡¹ç›®è“å›¾**: #1ï¼ˆNodeMUD é¡¹ç›®è“å›¾ï¼‰
- **å…³è” Scope**: #85ï¼ˆå‡ºç”Ÿç‚¹åœ°å›¾ â€” è£‚éš™é•‡ï¼‰ã€#63ï¼ˆLayer 3 æ¸¸æˆå¯¹è±¡å­ç±»ï¼‰
- **å‚è€ƒ**: ç‚é»„ MUDã€åŒ—å¤§ä¾ å®¢è¡Œã€æ”¾ç½®æ±Ÿæ¹–ã€mudcore æ¡†æ¶

## åŠŸèƒ½ç›®æ ‡

å°† NPC ä»"çº¸ç‰‡äºº"å‡çº§ä¸ºæœ‰å±æ€§ã€æœ‰è¡Œä¸ºã€å¯äº¤äº’çš„æ´»ç‰©ã€‚è®©ç©å®¶åœ¨è£‚éš™é•‡èƒ½çœ‹åˆ°ã€æŸ¥çœ‹ã€å¯¹è¯ã€äº¤æ˜“ NPCï¼ŒNPC ä¼šé—²èŠã€ä¼šå·¡é€»ã€ä¼šæ‰“æ¶ã€‚

## å½“å‰å¼•æ“èƒ½åŠ›

### å·²å…·å¤‡ï¼ˆéª¨æ¶ï¼‰

| æ¨¡å—             | èƒ½åŠ›                                                          | æ–‡ä»¶                                            |
| ---------------- | ------------------------------------------------------------- | ----------------------------------------------- |
| BaseEntity       | Dbase åŠ¨æ€å±æ€§ã€Environment å®¹å™¨ã€Events äº‹ä»¶ã€å¿ƒè·³ã€å»¶è¿Ÿè°ƒç”¨ | `server/src/engine/base-entity.ts`              |
| LivingBase       | åå­—/æè¿°ã€ç§»åŠ¨(go)ã€æŒ‡ä»¤æ‰§è¡Œã€æƒé™                           | `server/src/engine/game-objects/living-base.ts` |
| NpcBase          | å¿ƒè·³ AI é’©å­(onAI)ã€å¯¹è¯é’©å­(onChat)                          | `server/src/engine/game-objects/npc-base.ts`    |
| BlueprintFactory | å…‹éš†åˆ›å»º NPC å®ä¾‹(clone)                                      | `server/src/engine/blueprint-factory.ts`        |
| ObjectManager    | å¯¹è±¡æ³¨å†Œ/æ³¨é”€/GC                                              | `server/src/engine/object-manager.ts`           |
| HeartbeatManager | å‘¨æœŸå¿ƒè·³é©±åŠ¨                                                  | `server/src/engine/heartbeat-manager.ts`        |
| Area             | SpawnRule å®šä¹‰ï¼ˆblueprintId/roomId/count/intervalï¼‰           | `server/src/engine/game-objects/area.ts`        |
| å‰ç«¯ NpcList     | NpcCard å¡ç‰‡å±•ç¤ºï¼ˆåå­—/æ€§åˆ«/ç­‰çº§/è¡€æ¡ï¼‰                       | `client/src/components/game/NpcList/`           |
| Zustand Store    | nearbyNpcs æ•°æ® + setNpcs action                              | `client/src/stores/useGameStore.ts`             |

### å…³é”®ç¼ºå£ï¼ˆè‚‰ï¼‰

- NPC ä¸ä¼šå‡ºç°åœ¨æˆ¿é—´é‡Œï¼ˆæ—  SpawnManagerï¼‰
- NPC æ²¡æœ‰æ¨é€åˆ°å‰ç«¯ï¼ˆæ—  nearbyNpcs åè®®ï¼‰
- ç©å®¶æ— æ³•ä¸ NPC äº¤äº’ï¼ˆæ—  ask/look npc/buy ç­‰æŒ‡ä»¤ï¼‰
- NPC æ²¡æœ‰è¡Œä¸ºè¡¨ç°ï¼ˆæ—  chat é—²èŠã€æ— æˆ˜æ–— AIï¼‰
- NPC æ²¡æœ‰åŠŸèƒ½è§’è‰²ï¼ˆæ— å•†åº—ã€å¸ˆçˆ¶ã€ä»»åŠ¡ï¼‰

---

## ä¼ ç»Ÿ MUD NPC ç³»ç»Ÿå…¨è²Œï¼ˆå¯¹æ ‡å‚è€ƒï¼‰

### ç‚é»„ MUD CHARACTER ç»§æ‰¿ä½“ç³»

ç‚é»„ MUD ä¸­ç©å®¶(USER_OB)å’Œ NPC éƒ½ç»§æ‰¿ CHARACTER æ¨¡å—ï¼ŒCHARACTER åˆç»§æ‰¿å¤§é‡åŠŸèƒ½æ¨¡å—ï¼š

| æ¨¡å—        | åŠŸèƒ½                            | å¯¹åº”æˆ‘ä»¬çš„å®ç°              |
| ----------- | ------------------------------- | --------------------------- |
| F_NAME      | åç§°ç³»ç»Ÿï¼ˆä¸­æ–‡å/è‹±æ–‡ID/å¤´è¡”ï¼‰  | getName/getShort/getLong âœ… |
| F_DBASE     | åŠ¨æ€å±æ€§å­˜å–ï¼ˆset/add/deleteï¼‰  | Dbase API âœ…                |
| F_MOVE      | ç§»åŠ¨æ§åˆ¶                        | go() âœ…                     |
| F_MESSAGE   | æ¶ˆæ¯å¤„ç†                        | receiveMessage âœ…           |
| F_ATTRIBUTE | å±æ€§è®¡ç®—ï¼ˆå…ˆå¤©â†’åº”ç”¨å€¼ï¼‰         | âŒ å¾…è®¾è®¡                   |
| F_ATTACK    | æˆ˜æ–—ç³»ç»Ÿï¼ˆattack/defendï¼‰       | âŒ å¾…è®¾è®¡                   |
| F_DAMAGE    | ä¼¤å®³/æ­»äº¡ï¼ˆdie/reviveï¼‰         | âŒ å¾…è®¾è®¡                   |
| F_SKILL     | æŠ€èƒ½ç®¡ç†ï¼ˆset_skill/map_skillï¼‰ | âŒ å¾…è®¾è®¡                   |
| F_CONDITION | çŠ¶æ€ç³»ç»Ÿï¼ˆä¸­æ¯’/çœ©æ™•/å¢ç›Šï¼‰      | âŒ å¾…è®¾è®¡                   |
| F_FINANCE   | èµ„é‡‘ç®¡ç†ï¼ˆgold/silverï¼‰         | âŒ å¾…è®¾è®¡                   |
| F_TEAM      | ç»„é˜Ÿç³»ç»Ÿ                        | âŒ å¾…è®¾è®¡                   |
| F_ACTION    | è¡ŒåŠ¨æ§åˆ¶ï¼ˆæ˜¯å¦å¯è¡ŒåŠ¨ï¼‰          | âŒ å¾…è®¾è®¡                   |

### NPC å±æ€§ä½“ç³»

#### åŸºç¡€ä¿¡æ¯

```typescript
// ç‚é»„ MUD set() å±æ€§ â†’ å¯¹åº”æˆ‘ä»¬çš„ Dbase
set_name("åº—å°äºŒ", ({ "dian xiaoer", "xiaoer" }));  // ä¸­æ–‡å + è‹±æ–‡ ID
set("title", "è£‚éš™é•‡");         // å¤´è¡”/å½’å±
set("gender", "male");           // æ€§åˆ«
set("age", 25);                  // å¹´é¾„
set("race", "human");            // ç§æ—
set("long", "ä¸€ä¸ªå¿™ç¢Œçš„...");    // è¯¦ç»†æè¿°
```

#### æˆ˜æ–—ç›¸å…³

```typescript
set('combat_exp', 50000); // å®æˆ˜ç»éªŒï¼ˆå†³å®šæˆ˜æ–—åŠ›ï¼‰
set('attitude', 'peaceful'); // æ€åº¦ï¼špeaceful / neutral / aggressive
set('neili', 500); // å½“å‰å†…åŠ›
set('max_neili', 500); // æœ€å¤§å†…åŠ›
set('jiali', 30); // åŠ åŠ›å€¼
set('qi', 200); // æ°”
set('max_qi', 200); // æœ€å¤§æ°”
set('jing', 150); // ç²¾
set('max_jing', 150); // æœ€å¤§ç²¾
```

#### å…ˆå¤©å±æ€§

```typescript
set('str', 20); // è‡‚åŠ›ï¼ˆæ”»å‡»åŠ›ï¼‰
set('int', 15); // æ‚Ÿæ€§ï¼ˆå­¦ä¹ é€Ÿåº¦ï¼‰
set('con', 18); // æ ¹éª¨ï¼ˆé˜²å¾¡/è¡€é‡ï¼‰
set('dex', 16); // èº«æ³•ï¼ˆé—ªé¿/å‘½ä¸­ï¼‰
```

### NPC è¡Œä¸ºç³»ç»Ÿ

#### éšæœºé—²èŠ (chat)

```typescript
// æ¯æ¬¡å¿ƒè·³æœ‰ N% æ¦‚ç‡è§¦å‘ä¸€æ¡éšæœºæ¶ˆæ¯
set('chat_chance', 15); // 15% æ¦‚ç‡è§¦å‘
set('chat_msg', ['åº—å°äºŒæ“¦äº†æ“¦æ¡Œå­ã€‚', 'åº—å°äºŒå†å–é“ï¼šå®¢å®˜é‡Œè¾¹è¯·ï¼', 'åº—å°äºŒä¸œå¼ è¥¿æœ›ã€‚']);

// æˆ˜æ–—ä¸­çš„å¦ä¸€å¥—
set('chat_chance_combat', 30);
set('chat_msg_combat', ['åº—å°äºŒæƒŠæåœ°å¤§å–Šï¼šæ•‘å‘½ï¼', 'åº—å°äºŒæŠ±å¤´é¼ çªœã€‚']);
```

#### é—®ç­”å¯¹è¯ (inquiry)

```typescript
// ç©å®¶ ask npc about <keyword> è§¦å‘
set('inquiry', {
  è£‚éš™é•‡: 'è¿™ä½å®¢å®˜ï¼Œè£‚éš™é•‡è™½å°ï¼Œäº”è„ä¿±å…¨ã€‚åŒ—è¡—æœ‰è¯é“ºå’Œé“åŒ é“ºï¼Œå¾€å—æ˜¯æ‚è´§é“ºã€‚',
  é…’: 'æœ¬åº—æœ‰ä¸Šå¥½çš„å¥³å„¿çº¢ï¼ŒäºŒåä¸¤é“¶å­ä¸€å›ã€‚',
  æ¶ˆæ¯: 'å¬è¯´æœ€è¿‘è£‚è°·æ·±å¤„ä¸å¤ªå¹³ï¼Œæœ‰äººçœ‹åˆ°å¥‡æ€ªçš„å…‰èŠ’...',
  default: 'å°çš„ä¸å¤ªæ¸…æ¥šè¿™ä¸ªï¼Œå®¢å®˜è¿˜æ˜¯é—®é—®åˆ«äººå§ã€‚',
});
```

#### NPC ç±»å‹ç‰¹åŒ–

| NPC ç±»å‹ | ç»§æ‰¿/ç‰¹å¾          | æ ¸å¿ƒèƒ½åŠ›                       |
| -------- | ------------------ | ------------------------------ |
| æ™®é€š NPC | inherit NPC        | é—²èŠã€é—®ç­”ã€è¢« look            |
| å•†åº— NPC | NPC + F_VENDOR     | buy/sell/list å•†å“             |
| å¸ˆçˆ¶ NPC | NPC + F_MASTER     | worship æ‹œå¸ˆ / teach ä¼ æˆ      |
| å®ˆå« NPC | NPC + guard é€»è¾‘   | å·¡é€»ã€æ‹¦æˆªã€ä¸»åŠ¨æ”»å‡»æ•Œæ–¹       |
| æ€ªç‰© NPC | FIGHTER/CHALLENGER | ä¸»åŠ¨æ”»å‡»ã€æ‰è½æˆ˜åˆ©å“ã€å®šæ—¶åˆ·æ–° |
| ä»»åŠ¡ NPC | NPC + ä»»åŠ¡é€»è¾‘     | å‘å¸ƒ/æ£€æŸ¥/å®Œæˆä»»åŠ¡ã€ç»™å¥–åŠ±     |
| å¼•å¯¼ NPC | NPC + init è§¦å‘    | æ–°æ‰‹æ•™ç¨‹å¼•å¯¼ã€åˆå§‹åŒ–å¯¹è¯       |

### NPC äº¤äº’æŒ‡ä»¤

| æŒ‡ä»¤       | æ ¼å¼                      | åŠŸèƒ½                      |
| ---------- | ------------------------- | ------------------------- |
| look       | `look <npc>`              | æŸ¥çœ‹ NPC å¤–è²Œå’ŒçŠ¶æ€       |
| ask        | `ask <npc> about <topic>` | å‘ NPC è¯¢é—®ï¼Œè§¦å‘ inquiry |
| talk       | `talk <npc>`              | ä¸ NPC å¯¹è¯ï¼ˆäº¤äº’å¼ï¼‰     |
| buy        | `buy <item> from <npc>`   | ä»å•†åº— NPC è´­ä¹°           |
| sell       | `sell <item> to <npc>`    | å‘å•†åº— NPC å‡ºå”®           |
| list       | `list <npc>`              | æŸ¥çœ‹å•†åº—å•†å“åˆ—è¡¨          |
| worship    | `worship <npc>`           | æ‹œå¸ˆ                      |
| fight/kill | `fight <npc>`             | å‘èµ·æˆ˜æ–—                  |
| give       | `give <item> to <npc>`    | ç»™ NPC ç‰©å“               |

---

## é—¨æ´¾/åŠ¿åŠ›å­—æ®µç­–ç•¥

### å†³ç­–ï¼šå…ˆç”¨å¸¸é‡å­—ç¬¦ä¸²ï¼Œåé¢é—¨æ´¾ç³»ç»Ÿä¸Šçº¿å†å‡çº§

é—¨æ´¾/åŠ¿åŠ›æ˜¯ç‹¬ç«‹çš„å¤§ç³»ç»Ÿï¼ˆå†…éƒ¨ç­‰çº§ã€è´¡çŒ®åº¦ã€æŠ€èƒ½æ ‘ã€å…³ç³»ç½‘ï¼‰ï¼Œä¸åœ¨ Phase 0 è¿‡åº¦è®¾è®¡ã€‚

**ç°åœ¨**ï¼šNPC è“å›¾ç”¨ `faction` å­—ç¬¦ä¸²å­—æ®µï¼Œé…å¸¸é‡æ–‡ä»¶ç»Ÿä¸€ç®¡ç†åç§°ï¼Œé˜²æ­¢æ‹¼å†™ä¸ä¸€è‡´ã€‚

**åé¢**ï¼šé—¨æ´¾ç³»ç»Ÿåšå¥½åï¼Œ`faction` ä»å­—ç¬¦ä¸²å‡çº§ä¸ºé—¨æ´¾å¯¹è±¡å¼•ç”¨ï¼ŒNPC è“å›¾å›æ¥è¡¥å……é—¨æ´¾ç­‰çº§ã€èŒä½ç­‰ã€‚

#### åŠ¿åŠ›å¸¸é‡å®šä¹‰

```typescript
// packages/core/src/constants/factions.ts
export const Factions = {
  NONE: '', // æ— é—¨æ´¾
  CHENG_TIAN: 'æ‰¿å¤©æœ', // æœå»·
  SONG_YANG: 'åµ©é˜³å®—', // æ®‹å­˜ä¸‰é—¨
  YUN_YUE: 'äº‘å²³æ´¾',
  BI_LAN: 'ç¢§æ¾œé˜',
  AN_HE: 'æš—æ²³', // åœ°ä¸‹ç»„ç»‡
  LANG_TING: 'åŒ—æ¼ Â·ç‹¼åº­', // å¤–æ—
  SAN_MENG: 'ä¸œæµ·Â·æ•£ç›Ÿ', // æµ·ä¸Šè”ç›Ÿ
  BAI_MAN: 'è¥¿å—Â·ç™¾è›®', // è‹—ç–†éƒ¨è½
  XI_YU: 'è¥¿åŸŸÂ·é—æ°‘', // é—è¿¹å®ˆæŠ¤è€…
  TIAN_LIE: 'å¤©è£‚æ•™', // é‚ªæ•™
} as const;
```

#### è£‚éš™é•‡ NPC é—¨æ´¾å½’å±

| NPC      | æˆ¿é—´      | åŠ¿åŠ›å½’å±           | ç†ç”±                   |
| -------- | --------- | ------------------ | ---------------------- |
| è€é•‡é•¿   | é•‡ä¸­å¹¿åœº  | NONEï¼ˆä¸­ç«‹ï¼‰       | è£‚éš™é•‡æœ¬åœ°äºº           |
| é…’ä¿     | é…’é¦†      | NONEï¼ˆä¸­ç«‹ï¼‰       | æœ¬åœ°å•†äºº               |
| ç¥ç§˜æ—…äºº | é…’é¦†      | AN_HEï¼ˆéšè—ï¼‰      | æš—æ²³æ¢å­ï¼Œè¡¨é¢èº«ä»½ä¸æ˜ |
| å®¢æ ˆè€æ¿ | å®¢æ ˆ      | NONEï¼ˆä¸­ç«‹ï¼‰       | ä¸ˆå¤«æ˜¯å¤±è¸ªå®—é—¨å¼Ÿå­     |
| ç™½å‘è¯å¸ˆ | è¯é“º      | BAI_MANï¼ˆé€€éšï¼‰    | è¥¿å—è›®ç–†è¯å¸ˆå‡ºèº«       |
| è€å‘¨é“åŒ  | é“åŒ é“º    | CHENG_TIANï¼ˆé€€å½¹ï¼‰ | åŸåŒ—å¢ƒå†›é•‡å†›æ¢°åŒ        |
| æ‚è´§å•†   | æ‚è´§é“º    | SAN_MENG           | äº¦å•†äº¦åŒªçš„æµ·å•†èƒŒæ™¯     |
| è€ä¹ä¸   | å—è¡—      | NONE               | ä¿¡æ¯è´©å­               |
| å®ˆé—¨å«å…µ | åŒ—é—¨/å—é—¨ | CHENG_TIAN         | æœå»·æ´¾é©»               |
| å·¡é€»å…µ   | è£‚è°·åŒ—é“  | CHENG_TIAN         | æœå»·å·¡é€»               |
| è¡Œå•†     | è£‚è°·å—é“  | NONE               | ä¸­åŸå•†äºº               |

---

## å®ç°è§„åˆ’ â€” åˆ†é˜¶æ®µæ¨è¿›

### Phase 0: NPC æ´»è¿‡æ¥ + ä¼šè¯´è¯ï¼ˆåŸºç¡€ç”Ÿå­˜ + äº¤äº’ï¼‰

> ç›®æ ‡ï¼šNPC å‡ºç°åœ¨æˆ¿é—´ï¼Œç©å®¶èƒ½çœ‹åˆ°ã€æŸ¥çœ‹ã€å¯¹è¯ï¼ŒNPC ä¼šé—²èŠ

| åºå· | ä»»åŠ¡                    | ç±»å‹     | ä¾èµ– | è¯´æ˜                                                                 |
| ---- | ----------------------- | -------- | ---- | -------------------------------------------------------------------- |
| 0-1  | NPC å±æ€§æ‰©å±• + åŠ¿åŠ›å¸¸é‡ | backend  | æ—    | NpcBase åŠ  title/gender/faction/attitude ä¾¿æ·æ–¹æ³•ï¼›Factions å¸¸é‡æ–‡ä»¶ |
| 0-2  | è£‚éš™é•‡ NPC è“å›¾         | backend  | 0-1  | 8-10 ä¸ª NPC è“å›¾ + Area spawn_rules é…ç½®                             |
| 0-3  | SpawnManager åˆ·æ–°ç®¡ç†å™¨ | backend  | 0-2  | è¯»å– spawn_rulesï¼Œclone NPC æ”¾å…¥æˆ¿é—´ï¼Œå‘¨æœŸæ£€æŸ¥è¡¥åˆ·                   |
| 0-4  | NPC åˆ—è¡¨æ¨é€åè®®        | backend  | 0-3  | roomInfo é™„å¸¦ NPC åˆ—è¡¨ / ç‹¬ç«‹ nearbyNpcs æ¶ˆæ¯                        |
| 0-5  | å‰ç«¯ NPC çœŸå®æ•°æ®       | frontend | 0-4  | æ¥æ”¶æ¨é€æ›¿æ¢ mockï¼ŒNpcCard é€‚é…æ–°å­—æ®µï¼ˆfaction/titleï¼‰               |
| 0-6  | look NPC æŒ‡ä»¤           | backend  | 0-3  | `look <npcå>` è¿”å› long + title/faction/level                       |
| 0-7  | ask å¯¹è¯ + inquiry      | backend  | 0-3  | `ask <npc> about <topic>` åŒ¹é… inquiry mapping                       |
| 0-8  | chat é—²èŠç³»ç»Ÿ           | backend  | 0-3  | å¿ƒè·³ä¸­æŒ‰ chat_chance éšæœºå¹¿æ’­ chat_msg åˆ°æˆ¿é—´                        |

### Phase 2: NPC æœ‰åŠŸèƒ½ï¼ˆå•†åº—/äº¤æ˜“ï¼‰

> ç›®æ ‡ï¼šå•†åº— NPC å¯ä¹°å–ç‰©å“

| åºå· | ä»»åŠ¡                | ç±»å‹     | è¯´æ˜                               |
| ---- | ------------------- | -------- | ---------------------------------- |
| 2-1  | é‡‘é’±ç³»ç»Ÿ            | backend  | ç©å®¶/NPC çš„é‡‘é’±å±æ€§ï¼ˆgold/silverï¼‰ |
| 2-2  | ItemBase å®Œå–„       | backend  | ç‰©å“å±æ€§ï¼ˆä»·æ ¼/é‡é‡/ç±»å‹/æè¿°ï¼‰    |
| 2-3  | å•†åº—ç‰¹å¾ (F_VENDOR) | backend  | å•†å“åˆ—è¡¨ã€å®šä»·ã€ä¹°å–é€»è¾‘           |
| 2-4  | buy/sell/list æŒ‡ä»¤  | backend  | å•†åº—äº¤äº’æŒ‡ä»¤                       |
| 2-5  | å‰ç«¯å•†åº— UI         | frontend | å•†å“åˆ—è¡¨å¼¹çª—æˆ–é¢æ¿                 |

### Phase 3: NPC ä¼šæ‰“æ¶ï¼ˆæˆ˜æ–—ç³»ç»Ÿï¼‰

> ç›®æ ‡ï¼šåŸºç¡€å›åˆåˆ¶æˆ˜æ–—ï¼ŒNPC å¯è¢«æ”»å‡»/ä¸»åŠ¨æ”»å‡»

| åºå· | ä»»åŠ¡            | ç±»å‹     | è¯´æ˜                                   |
| ---- | --------------- | -------- | -------------------------------------- |
| 3-1  | æˆ˜æ–—å±æ€§ä½“ç³»    | backend  | combat_exp / æ”»å‡» / é˜²å¾¡ / å‘½ä¸­ / é—ªé¿ |
| 3-2  | æˆ˜æ–—å¾ªç¯        | backend  | å¿ƒè·³é©±åŠ¨å›åˆåˆ¶ï¼Œæ”»é˜²è®¡ç®—               |
| 3-3  | fight/kill æŒ‡ä»¤ | backend  | å‘èµ·æˆ˜æ–—                               |
| 3-4  | NPC æˆ˜æ–— AI     | backend  | å¿ƒè·³ä¸­åˆ¤æ–­æ•Œäºº â†’ é€‰æŠ€èƒ½ â†’ æ”»å‡»         |
| 3-5  | æ­»äº¡/æ‰è½/åˆ·æ–°  | backend  | die() + æˆ˜åˆ©å“ + SpawnManager é‡æ–°åˆ·æ–° |
| 3-6  | å‰ç«¯æˆ˜æ–—å±•ç¤º    | frontend | æˆ˜æ–—æ—¥å¿—ã€NPC è¡€æ¡å®æ—¶å˜åŒ–             |

### Phase 4: NPC èƒ½æ•™å­¦ï¼ˆå¸ˆå¾’ç³»ç»Ÿï¼‰

> ç›®æ ‡ï¼šæ‹œå¸ˆå­¦è‰ºï¼ŒNPC ä¼ æˆæŠ€èƒ½

| åºå· | ä»»åŠ¡                | ç±»å‹     | è¯´æ˜                        |
| ---- | ------------------- | -------- | --------------------------- |
| 4-1  | æŠ€èƒ½ç³»ç»Ÿ            | backend  | set_skill / æŠ€èƒ½ç­‰çº§ / ç»éªŒ |
| 4-2  | å¸ˆå¾’ç‰¹å¾ (F_MASTER) | backend  | å¯æ”¶å¾’ NPCã€æ•™æˆæ¡ä»¶        |
| 4-3  | worship/teach æŒ‡ä»¤  | backend  | æ‹œå¸ˆã€è¯·æ•™                  |
| 4-4  | å‰ç«¯æŠ€èƒ½ UI         | frontend | æŠ€èƒ½é¢æ¿ã€å­¦ä¹ è¿›åº¦          |

### Phase 5: NPC ç»™ä»»åŠ¡ï¼ˆä»»åŠ¡ç³»ç»Ÿï¼‰

> ç›®æ ‡ï¼šä»»åŠ¡ NPC å‘å¸ƒä»»åŠ¡ï¼Œç©å®¶å®Œæˆè·å¾—å¥–åŠ±

| åºå· | ä»»åŠ¡          | ç±»å‹     | è¯´æ˜                             |
| ---- | ------------- | -------- | -------------------------------- |
| 5-1  | ä»»åŠ¡å¼•æ“      | backend  | ä»»åŠ¡å®šä¹‰ã€çŠ¶æ€æœºã€æ¡ä»¶åˆ¤æ–­       |
| 5-2  | ä»»åŠ¡ NPC å¯¹è¯ | backend  | ask è§¦å‘ä»»åŠ¡ã€æ£€æŸ¥è¿›åº¦ã€äº¤ä»˜å¥–åŠ± |
| 5-3  | å‰ç«¯ä»»åŠ¡é¢æ¿  | frontend | ä»»åŠ¡åˆ—è¡¨ã€è¿›åº¦è¿½è¸ª               |

---

## ä¸æ”¾ç½®æ±Ÿæ¹–çš„å¯¹æ¯”

| åŠŸèƒ½           | æ”¾ç½®æ±Ÿæ¹–      | æˆ‘ä»¬çš„ç›®æ ‡       | å®ç° Phase |
| -------------- | ------------- | ---------------- | ---------- |
| NPC å‡ºç°åœ¨åœºæ™¯ | âœ…            | âœ…               | Phase 0    |
| æŸ¥çœ‹ NPC       | âœ…            | âœ…               | Phase 0    |
| NPC å¯¹è¯       | âœ… æ–‡å­—å¯¹è¯   | âœ… ask é—®ç­”      | Phase 0    |
| å•†åº—äº¤æ˜“       | âœ… å‹å¥½åº¦è§£é” | âœ… buy/sell      | Phase 2    |
| åˆ‡ç£‹/æˆ˜æ–—      | âœ… ç«æŸ´äºº     | âœ… æ–‡å­—å›åˆåˆ¶    | Phase 3    |
| æ‹œå¸ˆå­¦è‰º       | âœ… é—¨æ´¾ç³»ç»Ÿ   | âœ… worship/teach | Phase 4    |
| ä»»åŠ¡ç³»ç»Ÿ       | âœ… éšè—ä»»åŠ¡   | âœ… ask è§¦å‘      | Phase 5    |
| NPC æ€§æ ¼/æ€åº¦  | âœ…            | âœ… attitude      | Phase 0    |
| å‹å¥½åº¦ç³»ç»Ÿ     | âœ… é€ç¤¼æå‡   | ğŸ”œ åç»­è€ƒè™‘      | -          |
| é—¨æ´¾ç³»ç»Ÿ       | âœ… 28 é—¨æ´¾    | ğŸ”œ åç»­è€ƒè™‘      | -          |

## å¼€æ”¾é—®é¢˜

- [ ] NPC å±æ€§ä½“ç³»æ˜¯å¦æ²¿ç”¨æˆ‘ä»¬çš„å…­ç»´ï¼ˆwisdom/perception/spirit/meridian/strength/vitalityï¼‰ï¼Œè¿˜æ˜¯æ”¹ä¸ºä¼ ç»Ÿ MUD çš„å››ç»´ï¼ˆstr/int/con/dexï¼‰ï¼Ÿ
- [ ] æˆ˜æ–—ç³»ç»Ÿæ˜¯å®æ—¶å¿ƒè·³å›åˆåˆ¶ï¼ˆä¼ ç»Ÿ MUDï¼‰è¿˜æ˜¯æŒ‡ä»¤è§¦å‘å›åˆåˆ¶ï¼Ÿ
- [ ] å•†åº— NPC çš„å•†å“æ•°æ®å¦‚ä½•å­˜å‚¨ï¼Ÿè“å›¾å†…ç›´æ¥å®šä¹‰è¿˜æ˜¯å•ç‹¬æ•°æ®è¡¨ï¼Ÿ
- [ ] ä»»åŠ¡ç³»ç»Ÿçš„å¤æ‚åº¦è¾¹ç•Œï¼Ÿç®€å•çš„äº¤ä»˜ä»»åŠ¡è¿˜æ˜¯æ”¯æŒå¤šæ­¥éª¤/æ¡ä»¶ä»»åŠ¡é“¾ï¼Ÿ
- [ ] NPC çš„ AI å¤æ‚åº¦ï¼Ÿçº¯éšæœºè¡Œä¸º vs çŠ¶æ€æœº vs è¡Œä¸ºæ ‘ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦ NPC å¥½æ„Ÿåº¦ç³»ç»Ÿï¼Ÿï¼ˆæ”¾ç½®æ±Ÿæ¹–æœ‰æ­¤æœºåˆ¶ï¼‰

## æ¢è®¨è®°å½•

### 2026-02-04 åˆå§‹è®¨è®º

åŸºäºå¯¹ç‚é»„ MUDã€åŒ—å¤§ä¾ å®¢è¡Œã€æ”¾ç½®æ±Ÿæ¹–ã€mudcore æ¡†æ¶çš„å¯¹æ ‡åˆ†æï¼Œæ¢³ç†äº†ä¼ ç»Ÿ MUD NPC ç³»ç»Ÿçš„å®Œæ•´èƒ½åŠ›å›¾è°±ï¼Œè¯†åˆ«å‡ºæˆ‘ä»¬çš„å¼•æ“éª¨æ¶å·²å°±ç»ªä½†"è‚‰"å…¨éƒ¨ç¼ºå¤±ã€‚åˆ¶å®šäº† Phase 0-5 çš„åˆ†é˜¶æ®µå®ç°è·¯çº¿ã€‚

### 2026-02-04 é—¨æ´¾å­—æ®µ + Phase 0 èŒƒå›´è°ƒæ•´

**å†³ç­–**ï¼šé—¨æ´¾/åŠ¿åŠ›å­—æ®µé‡‡ç”¨ã€Œå…ˆå¸¸é‡å­—ç¬¦ä¸²ï¼Œåå‡çº§å¼•ç”¨ã€ç­–ç•¥ã€‚ç°åœ¨å®šä¹‰ Factions å¸¸é‡ï¼ˆæ”¾ packages/coreï¼‰ï¼ŒNPC è“å›¾é€šè¿‡å¸¸é‡è®¾ç½® factionã€‚åç»­é—¨æ´¾ç³»ç»Ÿä¸Šçº¿æ—¶å†å‡çº§ä¸ºå¯¹è±¡å¼•ç”¨ï¼Œå›æ¥è¡¥å…… NPC çš„é—¨æ´¾ç­‰çº§å’ŒèŒä½ã€‚

**Phase 0 èŒƒå›´è°ƒæ•´**ï¼šå°† chat é—²èŠå’Œ ask å¯¹è¯ä» Phase 1 åˆå¹¶åˆ° Phase 0ã€‚ç†ç”±ï¼šNPC "ä¼šè¯´è¯"æ˜¯ä¸–ç•Œæ´»ç€çš„å…³é”®ä½“éªŒï¼Œå®ç°æˆæœ¬ä½ï¼ˆå¿ƒè·³éšæœºé€‰ chat_msg + inquiry mapping åŒ¹é…ï¼‰ï¼Œä¸åº”æ¨è¿Ÿã€‚Phase 0 è°ƒæ•´ä¸º 8 ä¸ªä»»åŠ¡ã€‚

å‚è€ƒèµ„æ–™ï¼š

- [ç‚é»„ MUD NPC å¼€å‘æ•™ç¨‹](https://mud.ren/threads/211)
- [ç‚é»„ MUD GitHub](https://github.com/oiuv/mud)
- [mudcore æ¡†æ¶](https://github.com/oiuv/mudcore)
- [åŒ—å¤§ä¾ å®¢è¡Œ](https://pkuxkx.net/)
- [MUD å·«å¸ˆå…¥é—¨æ•™ç¨‹](https://www.cnblogs.com/cfas/p/5875612.html)
- [æ”¾ç½®æ±Ÿæ¹–](https://www.taptap.cn/app/11981)

---

> CX å·¥ä½œæµ | åŠŸèƒ½æ¢è®¨
